---
title: "ラッシュ分析について"
author: "小野裕介"
date: "2016年11月9日"
output: word_document
---
## < 本日の発表 >
＊評価指標について学ぶこと(例：LIFE)、有用な評価指標を開発することは本勉強会の柱になっている。
今回は、指標の特性を理解するためのの枠組みとしてラッシュ理論を紹介する。

＊評価・測定の方法がねらい通りに測りたいものを測っているかどうかという性質を、妥当性(validity)という。項目群が同じものを測っているという性質を内的整合性、または内的一貫性(internal consistency)と呼ぶ。内的一貫性を検討には、古典的なテスト理論の枠組みでは、合計点との相関を用いる方法や、Cronbachのα係数を用いる方法が用いられる。今回は、ラッシュモデルという古典的なテスト理論とは異なる枠組みを用いて内的一貫性について検討する方法を紹介する。

## < ラッシュモデルとは >

### [ ラッシュモデルとは ]
＊ラッシュモデルは「測定の客観性」を追求していったときに必然的に到達する唯一のモデル。

＊ラッシュモデルは測定のあるべき姿の数学的表現。

### [ ラッシュモデルの目的 ]
＊データの説明を目的としているのではない。

＊客観的な測定結果が得られるようにデータを整備して、意味のある構成概念を作り出すことが目的。

## < 測定の客観性とラッシュモデルの導出 >
### [ 測定の客観性 ]
＊測定が客観的とは：測定器具を変えても測定結果が変わらないということ。

＊例1
砲丸に2つの力を加え、それぞれの加速度を比較することで、加えられた力を推定する。
このとき、砲丸の質量がどのような値でも、例えば2倍の力を加えれば加速度は常に2倍になる。
この結果は砲丸によらない。

＊例2
上の例で砲丸を「テスト」、力を「生徒の実力」、加速度を「点数」とする。
生徒の点数は、実力だけでなくテストの問題の内容によっても左右されることがある。
例えば、極端に難しい問題では生徒間の実力の違いが点数として反映されない。


### [ ラッシュモデルの導出 ]

＊ある人(a)が、ある問題(i)を正しく解ける確率を$P_{ia}$とする。

＊ここで仮想的に、「標準的な実力の人」、「標準的な難易度の問題」というものを考える。

＊「標準的な実力の人」が問題(i)を解ける確率を$P_{i0}$と表記する。
問題(i)の難易度を、「標準的な実力の人が問題iを解けないオッズの対数」$\ln{\frac{1-P_{i0}}{P_{i0}}}$
で表せる。
これを$\eta_i$とする。

＊また、ある人(a)が「標準的な難易度の問題」を解ける確率を$P_{0a}$と表記する。
ある人(a)の実力は、「aさんが標準的な問題を解けるオッズの対数」$\ln{\frac{P_{0a}}{1-P_{0a}}}$
で表せる。
これを$\theta_a$とする。

＊「標準的な実力の人」が「標準的な難易度の問題」を解ける確率($P_{00}$)は$0.5$だとする。

＊このとき、先に述べた意味で測定に客観性があるとする。
すなわち、「aさんの実力」を「標準的な実力の人」の実力を基準にして測定した場合、それは問題によらないとする。
<!---
ここでは、「aさんが問題を解けるオッズ」と「標準的な実力の人が問題を解けるオッズ」の比率(オッズ比)が問題によらないとする。
そのとき、「aさんが問題iを解けるオッズ」と「標準的な実力の人が問題iを解けるオッズ」の比率は、
--->
このことを式で表すと、
$$
\ln{\frac{P_{ia}}{1-P_{ia}}}-\ln{\frac{P_{i0}}{1-P_{i0}}}=
\ln{\frac{P_{0a}}{1-P_{0a}}}-\ln{\frac{P_{00}}{1-P_{00}}}
$$
となる。
この式の左辺は、問題$i$に関して、「aさんの実力」($P_{ia}$)を「標準的な実力の人」の実力($P_{i0}$)を基準にして測定している。
一方右辺は、標準的な問題に関して、「aさんの実力」($P_{0a}$)を「標準的な実力の人」の実力($P_{00}$)を基準にして測定している。
測定の客観性を満たすのならば、両者は等しいはずである。

＊上の式から、「aさんが問題iを解けるオッズの対数」($\ln{\frac{P_{ia}}{1-P_{a}}}$ )は、$\theta_a$と$\eta_i$との差になることがわかる。
$$
\ln{\frac{P_{ia}}{1-P_{ia}}}=\theta_a - \eta_i
$$

### [ モデルとデータの関係：項目応答理論との比較(静 2007) ]
＊項目応答理論：「データにモデルを合わせる」ことでデータの構造をできる限り解明しようとする。手元にあるデータを最大限に忠実に描写するモデルを作り出す。
例えば、項目応答理論では、項目の難度に加えて項目弁別力というパラメータをモデルに導入する。
その結果、能力レベルによって難易度が逆転するという状況も表現できるようになる。
しかし、そのような測定は、(上で述べたような厳密な)「測定の客観性」は満たさない。

＊ラッシュモデル：「モデルにデータを合わせる」ことで客観的な測定結果を得ようとする。
ラッシュモデルの観点からは、「よりよくデータを描写できても、そのデータの構造は測定の原則に照らして意味不明」、「パラメータを増やすときりがないし、測定の意味を不明にするだけ」、「パラメータの多いモデルはテスト作成者の反省を促さない」とのこと。
かといって、ラッシュモデルでは、データを軽視しているわけではない。
「ラッシュパラダイムのなかでモデルの果たす機能は、データのなかにある異常をあばくことによってそのデータ理解を深めることであり、単にデータに沿うようモデルを調整することではない」とのこと。

＊まとめ：「データとモデルの関係についての伝統的な見方は、まず神聖不可侵であるデータが収集され、そのデータをうまく説明するようなモデルが選ばれる、というものであった。ラッシュモデルはこの関係をひっくり返す。というのは、ラッシュモデルが選択されるべき理由が、なにかのデータをうまく説明するからではなく、数学的にかつ検証可能な方法で、測定というものが成り立つための要件を示すからだ」(p.366)。

### < Rを用いて試してみる >
＊eRmというライブラリを使う。
```{r}
library(eRm)
```

＊eRmに含まれるraschdat1というデータの例を使う。
````{r}
str(raschdat1)
```
これは100人が30題からなるテストを受けた結果を表すデータだと考えられる。

＊最初の６人分は以下の通りである。1が正解であるとする。
````{r}
head(raschdat1)
```

＊ラッシュモデルで項目別に$\eta$を推定する。推定された式をいくつかの項目について表示する。
横軸は受験者の実力$\theta$を表す。
このグラフを項目特性曲線(item characteristic curve; ICC)と呼ぶ。
````{r}
res.rasch <- RM(raschdat1)
plotICC(res.rasch, item.subset=1:4)
```

＊ICCは交わらない。上(もしくは左)にあることは、その問題が易しいことを意味する。
````{r}
plotjointICC(res.rasch, item.subset=1:4)
```

＊全ての問題について表示すると以下のようになる。
````{r}
plotjointICC(res.rasch, item.subset="all")
```

＊全体の適合度について調べる
````{r}
lrres.rasch <- LRtest(res.rasch, splitcr="mean")
lrres.rasch
```

＊項目の適合度を調べる
````{r}
itemfit(person.parameter(res.rasch))
```

・データが完全にラッシュモデルに合致しているのならば、残差はカイ二乗分布にしたがう。
よって、p値が低ければ、不適合とみなすことになる。

・一般的に、平方平均が0.7から1.3の範囲から外れていると不適合とみなす。
下に外れている場合をオーバーフィット、上に外れている場合をアンダーフィットと呼ぶ。
アンダーフィットは、ランダム性が強く、ラッシュモデルが期待する弁別力を持っていないことを意味する。
一方、オーバーフィットは逆に、ラッシュモデルの観点からみてあまりにランダム性が乏しいことを意味する。


＊Person-Item Mapを描く
````{r}
plotPImap(res.rasch, sorted=TRUE)
````


<!--
＊
````{r}
plotGOF(lrres.rasch, beta.subset = c(14, 5, 18, 7, 1), tlab = "item", conf = list(ia = FALSE, col = "blue", lty = "dotted"))
```
-->

### 論文

#### [宮田和弘ほか「BESTest, Mini-BESTest, Brief-BESTestにおける得点分布の特性と転倒予測精度に関する検討: 前向きコホート研究. 理学療法学 43巻2号. 2016年.](https://www.jstage.jst.go.jp/article/rigaku/43/2/43_11097/_article/-char/ja/)

＊BESTest, Mini-BESTest, Brief-BESTest, BBSの得点分布の特性と転倒予測精度を比較。

＊BESTest：運動制御理論のひとつであるシステム理論に基いてHorakらにより考案されたバランス機能評価。
バランス障害に対して特異的に介入できるようにバランスを6つの制御システムとして捉える。
6つの制御システムとは、生体力学的制約、安定限界、姿勢変化-予測的姿勢制御、反応的姿勢制御、感覚機能、歩行安定性である。

＊Mini-BESTest(Franchignoniら)：BESTestの短縮版。
BESTestの6セクション36課題から、因子分析とRasch分析にて動的バランス機能の評価に最低限必要な4セクション14項目を抽出して作成。

＊Brief-BESTest(Padgettら)：BESTestの6セクションから相関分析にて1項目ずつ抽出して作成。Mini-BESTestのうち4セクションしか評価できない点を改善。

#### [ Bravini et al. Does the Brief-BESTest Meet Classical Test Theory and Rasch Analysis Requirements for Balance Assessment in People With Neurological Disorders? Physical Therapy. 96(10). 2016. ](http://ptjournal.apta.org/content/96/10/1610)


＊バランスの指標であるBESTestの簡易版のうちの１つであるBrief-BESTestの内的構成妥当性を、古典的なテスト理論(CTT; Classical Test Theory)とラッシュ分析を用いて検討する。

＊ラッシュ分析による内的一貫性の検討：項目難易度と被験者の能力を推定したうえで、各項目の適合度の検討(Table 3.)

・infit MnsqとOutfit Mnsqをもとめる. ここではinfitを重視.

・overfitting, underfittingの検討

・Person-Item Mapによる天井効果の検討(Figure 2.)

### 参考文献
- 静哲人『基礎から深く理解するラッシュモデリング』, 関西大学出版部, 2003.

- [京極真「図解　Rでラッシュモデル：eRmパッケージ 」](https://kyougokumakoto.blogspot.jp/2015/11/rerm_31.html)

- [京極真 「作業療法士のためのラッシュモデルと項目反応理論の解説」](https://kyougokumakoto.blogspot.jp/2016/10/blog-post_9.html)

- [宮田和弘ほか「BESTest, Mini-BESTest, Brief-BESTestにおける得点分布の特性と転倒予測精度に関する検討: 前向きコホート研究. 理学療法学 43巻2号. 2016年.](https://www.jstage.jst.go.jp/article/rigaku/43/2/43_11097/_article/-char/ja/)

- [Package ‘eRm’](https://cran.r-project.org/web/packages/eRm/eRm.pdf)

- [ Bravini et al. Does the Brief-BESTest Meet Classical Test Theory and Rasch Analysis Requirements for Balance Assessment in People With Neurological Disorders? Physical Therapy. 96(10). 2016.](http://ptjournal.apta.org/content/96/10/1610)

- [Patrick Mair et al. "Extended Rasch Modeling: The R Package eRm"](https://cran.r-project.org/web/packages/eRm/vignettes/eRm.pdf)




